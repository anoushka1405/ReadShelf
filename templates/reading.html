{% extends "base.html" %}

{% block head %}
    <title>Currently Reading | ReadShelf</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='reading.css') }}">
{% endblock %}

{% block content %}
    <h1 class="heading">📘 Currently Reading</h1>
    <p class="subheading">Your current adventures await 📖</p>

    <a class="add-btn" href="/">🏠 Back to Shelf</a>
    <a class="add-btn" href="/add">➕ Add Book</a>
    <a class="add-btn" href="/wishlist">📖 Wishlist</a>

    <form method="GET" action="{{ url_for('currently_reading') }}" class="mood-filter-form">
        <label for="mood">Filter by Mood:</label>
        <select name="mood" id="mood" onchange="this.form.submit()">
            <option value="">All Moods</option>
            {% for mood in mood_config %}
                <option value="{{ mood }}" {% if selected_mood == mood %}selected{% endif %}>
                    {{ mood }} {{ mood_config[mood]['emoji'] }}
                </option>
            {% endfor %}
        </select>
    </form>

    <div class="bookshelf wishlist">
        {% for book in books %}
            {% set mood = book[3] %}
            {% set mood_data = mood_config.get(mood, {'emoji': '📘', 'color': '#e0f7ff'}) %}

            <div class="book" style="background-color: {{ mood_data.color }}">
                <div class="mood-emoji">{{ mood_data.emoji }}</div>
                <div class="title"><strong>{{ book[1] }}</strong></div>
                <div class="author"><em>{{ book[2] }}</em></div>
                <div class="rating">⭐ {{ book[5] }}/5</div>
                <a href="{{ url_for('update_book', book_id=book[0]) }}" class="mark-read-link" data-href="{{ url_for('update_book', book_id=book[0]) }}">
                    🎉 Mark as Read
                </a>
            </div>
        {% else %}
            <p class="empty-msg">You’re not reading anything right now. Add a current read!</p>
        {% endfor %}
    </div>
{% endblock %}

{% block scripts %}
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
<script src="{{ url_for('static', filename='reading.js') }}"></script>
{% endblock %}
