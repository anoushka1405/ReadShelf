<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>ReadShelf Export</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; padding: 2rem; }
    h1, h2 { color: #333; }
    p.summary {
      margin-bottom: 2rem;
      font-size: 1rem;
      line-height: 1.6;
    }
    .book-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 1rem;
      margin-bottom: 2rem;
    }
    .book-card {
      border: 1px solid #ccc;
      padding: 1rem;
      border-radius: 8px;
      background: #f9f9f9;
      break-inside: avoid;
      text-align: center;
    }
    .book-cover {
      width: 100%;
      height: auto;
      max-height: 160px;
      object-fit: contain;
      border-radius: 6px;
      margin-bottom: 0.5rem;
    }
    .charts {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 1.5rem;
      margin-top: 2rem;
      page-break-inside: avoid;
    }
    .chart-img {
      max-width: 250px;
      border: 1px solid #ccc;
      border-radius: 8px;
      padding: 0.5rem;
      background: white;
    }
  </style>
</head>
<body>
  <h1>üìö ReadShelf Summary</h1>

  <p class="summary">
    Here's a snapshot of your reading journey so far ‚Äî neatly categorized into your completed reads, ongoing adventures, and books you're saving for later. Dive in and relive each page!
  </p>


{% set read_books = books_by_status.get('read', []) %}
{% set reading_books = books_by_status.get('currently_reading', []) %}
{% set wishlist_books = books_by_status.get('wishlist', []) %}



  {% if read_books %}
  <h2>‚úÖ Completed Reads</h2>
  <div class="book-grid">
    {% for book in read_books %}
    <div class="book-card">
      {% if book.cover %}
        <img src="{{ book.cover }}" alt="Cover of {{ book.title }}" class="book-cover">
      {% else %}
        <div style="font-size: 3rem;">üìò</div>
      {% endif %}
      <strong>{{ book.title }}</strong><br>
      <em>{{ book.author or "Unknown Author" }}</em><br>
      Mood: {{ book.mood or "N/A" }}<br>
      Rating: {{ book.rating or "N/A" }}
    </div>
    {% endfor %}
  </div>
  {% endif %}

  {% if reading_books %}
  <h2>üìñ Currently Reading</h2>
  <div class="book-grid">
    {% for book in reading_books %}
    <div class="book-card">
      {% if book.cover %}
        <img src="{{ book.cover }}" alt="Cover of {{ book.title }}" class="book-cover">
      {% else %}
        <div style="font-size: 3rem;">üìò</div>
      {% endif %}
      <strong>{{ book.title }}</strong><br>
      <em>{{ book.author or "Unknown Author" }}</em><br>
      Mood: {{ book.mood or "N/A" }}<br>
      Rating: {{ book.rating or "N/A" }}
    </div>
    {% endfor %}
  </div>
  {% endif %}

  {% if wishlist_books %}
  <h2>üìù Wishlist</h2>
  <div class="book-grid">
    {% for book in wishlist_books %}
    <div class="book-card">
      {% if book.cover %}
        <img src="{{ book.cover }}" alt="Cover of {{ book.title }}" class="book-cover">
      {% else %}
        <div style="font-size: 3rem;">üìò</div>
      {% endif %}
      <strong>{{ book.title }}</strong><br>
      <em>{{ book.author or "Unknown Author" }}</em><br>
      Mood: {{ book.mood or "N/A" }}<br>
      Rating: {{ book.rating or "N/A" }}
    </div>
    {% endfor %}
  </div>
  {% endif %}

  <h2>üìä Stats</h2>
  <div class="charts">
    <div>
      <h3>Books by Mood</h3>
      <img class="chart-img" src="data:image/png;base64,{{ pie_chart }}" alt="Books by Mood Pie Chart" />
    </div>
    <div>
      <h3>Average Rating by Mood</h3>
      <img class="chart-img" src="data:image/png;base64,{{ bar_chart }}" alt="Average Rating by Mood Bar Chart" />
    </div>
    <div>
      <h3>Books per Rating</h3>
      <img class="chart-img" src="data:image/png;base64,{{ rating_chart }}" alt="Books per Rating Bar Chart" />
    </div>
  </div>
</body>
</html>
